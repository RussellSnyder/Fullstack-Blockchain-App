{"version":3,"sources":["../../src/api/index.js"],"names":["BLOCKS_OVERVIEW_ENDPOINT","RAW_BLOCK_ENDPOINT","config","db","api","use","get","req","res","axios","then","response","blocks","data","map","BasicBlock","block","json","catch","error","status","text","hash","params","RawBlock"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,2BAA2B,4CAAjC;AACA,IAAMC,qBAAqB,mCAA3B;;kBAEe,gBAAoB;AAAA,QAAjBC,MAAiB,QAAjBA,MAAiB;AAAA,QAATC,EAAS,QAATA,EAAS;;AAClC,QAAIC,MAAM,sBAAV;;AAEA;AACAA,QAAIC,GAAJ,CAAQ,SAAR,EAAmB,sBAAO,EAAEH,cAAF,EAAUC,MAAV,EAAP,CAAnB;;AAEAC,QAAIE,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AACpB,eAAOC,gBAAMH,GAAN,CAAUN,wBAAV,EACFU,IADE,CACG,UAAUC,QAAV,EAAoB;AACtB,gBAAMC,SAASD,SAASE,IAAT,CAAcD,MAAd,CAAqBE,GAArB,CAAyB;AAAA,uBAAS,IAAIC,oBAAJ,CAAeC,KAAf,CAAT;AAAA,aAAzB,CAAf;AACAR,gBAAIS,IAAJ,CAAS,EAAEL,cAAF,EAAT;AAEH,SALE,EAMFM,KANE,CAMI,UAAUC,KAAV,EAAiB;AACpBX,gBAAIS,IAAJ,CAAS,EAAEE,OAAQ;AACXC,4BAAQ,GADG;AAEXC,0BAAM,sBAFK;AAGXF;AAHW;AAAV,aAAT;AAMH,SAbE,CAAP;AAcN,KAfD;;AAiBAf,QAAIE,GAAJ,CAAQ,cAAR,EAAwB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC/B,YAAMc,OAAOf,IAAIgB,MAAJ,CAAWD,IAAxB;;AAEA,eAAOb,gBAAMH,GAAN,CAAUL,qBAAqBqB,IAA/B,EACFZ,IADE,CACG,UAAUC,QAAV,EAAoB;AACtB,gBAAMK,QAAQ,IAAIQ,kBAAJ,CAAab,SAASE,IAAtB,CAAd;AACAL,gBAAIS,IAAJ,CAAS,EAAED,YAAF,EAAT;AACH,SAJE,EAKFE,KALE,CAKI,UAAUC,KAAV,EAAiB;AACpBX,gBAAIS,IAAJ,CAAS,EAAEE,OAAQ;AACXC,4BAAQ,GADG;AAEXC,6DAAuCC,IAF5B;AAGfH;AAHe;AAAV,aAAT;AAMH,SAZE,CAAP;AAaN,KAhBD;;AAkBA,WAAOf,GAAP;AACA,C","file":"index.js","sourcesContent":["import { Router } from 'express';\nimport facets from './facets';\nimport BasicBlock from '../models/BasicBlock';\nimport axios from \"axios\";\nimport RawBlock from \"../models/RawBlock\";\n\nconst BLOCKS_OVERVIEW_ENDPOINT = \"https://blockchain.info/blocks?format=json\"\nconst RAW_BLOCK_ENDPOINT = \"https://blockchain.info/rawblock/\"\n\nexport default ({ config, db }) => {\n\tlet api = Router();\n\n\t// mount the facets resource\n\tapi.use('/facets', facets({ config, db }));\n\n\tapi.get('/', (req, res) => {\n        return axios.get(BLOCKS_OVERVIEW_ENDPOINT)\n            .then(function (response) {\n                const blocks = response.data.blocks.map(block => new BasicBlock(block));\n                res.json({ blocks });\n\n            })\n            .catch(function (error) {\n                res.json({ error : {\n                        status: 500,\n                        text: \"could not get blocks\",\n                        error\n                    }\n                });\n            })\n\t});\n\n\tapi.get('/block/:hash', (req, res) => {\n        const hash = req.params.hash;\n\n        return axios.get(RAW_BLOCK_ENDPOINT + hash)\n            .then(function (response) {\n                const block = new RawBlock(response.data)\n                res.json({ block });\n            })\n            .catch(function (error) {\n                res.json({ error : {\n                        status: 500,\n                        text: `could not get block with hash ${hash}`,\n                    error\n                    }\n                });\n            })\n\t});\n\n\treturn api;\n}\n"]}